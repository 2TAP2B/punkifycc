---
import type { NavLink } from '~/types'

interface Props {
  link: NavLink
}

const { link } = Astro.props
const hasChildren = link.children && link.children.length > 0
---

{hasChildren ? (
  <div class="relative group">
    <button
      class="underline flex items-center gap-1 cursor-pointer"
      type="button"
      aria-expanded="false"
    >
      {link.name}
      <span class="text-xs"></span>
    </button>
    <ul class="invisible group-hover:visible absolute top-full left-0 mt-1 bg-background border-2 border-accent/20 rounded-xl shadow-lg z-50 min-w-40 p-2">
      {link.children?.map((child) => (
        <li class="mb-1 last:mb-0">
          <a
            class="block px-3 py-2 rounded-lg hover:bg-accent/10 underline text-sm"
            rel={child.external ? 'noopener noreferrer' : undefined}
            target={child.external ? '_blank' : undefined}
            href={child.url}
          >
            {child.name}
          </a>
        </li>
      ))}
    </ul>
  </div>
) : (
  <a
    class="underline"
    rel={link.external ? 'noopener noreferrer' : undefined}
    target={link.external ? '_blank' : undefined}
    href={link.url}
  >
    {link.name}
  </a>
)}
